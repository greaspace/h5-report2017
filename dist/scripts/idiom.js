"use strict";var DATA_IDIOM={"工匠精神":{id:".ui-daiyan",input:"工匠精神大刀阔斧万民",image:"./images/idiom/gjjs.png"},"简政放权":{id:".ui-shigan",input:"简政放权因地制宜有矢",image:"./images/idiom/jzfq.png"},"体恤民心":{id:".ui-gongpu",input:"体恤民心所向披靡风云",image:"./images/idiom/txmx.png"},"日理万机":{id:".ui-feiren",input:"日理万机事如意操劳夜",image:"./images/idiom/rlwj.png"},"高瞻远瞩":{id:".ui-tuixiao",input:"高瞻远瞩山流水近闻明",image:"./images/idiom/gzyz.png"},"筚路蓝缕":{id:".ui-daoshi",input:"筚路蓝缕天白云千丝万",image:"./images/idiom/blll.png"}};!function(i){function n(i){i.stopPropagation()}i.fn._show=i.fn.show,i.fn.show=function(i,e){return this._show(i,e).on("ui.shown",n).trigger("ui.shown")},i.fn._hide=i.fn.hide,i.fn.hide=function(i,e){return this._hide(i,e).on("ui.hidden",n).trigger("ui.hidden")}}(jQuery),$(function(){function i(){var i=$(this);i.is(".selected")?l.trigger("answer.cancel",i.text()):(i.addClass("selected bounce"),l.trigger("answer.answer",i.text()),m.push(i))}function n(i,n){var e=DATA_IDIOM[i];r=e,$("#gameImage").attr("src",e.image),$("#gameAnswer").data("answer",i);var t=e.input.split(""),o=t.shift();t.sort().unshift(o),$.each(t,function(i,n){$(p.get(i)).text(n)}),n&&n()}function e(i,n){$("#redirect").show(function(){$(".ui-redirect-gate").one(h,function(){$(this).removeClass("redirect-animation-close"),i&&i(),$(this).one(h,function(){n&&n(),$("#redirect").hide(),$(this).removeClass("redirect-animation-open")}).addClass("redirect-animation-open")}).addClass("redirect-animation-close")})}function t(i){var n=["slide","bounce","zoom"][Math.floor(3*Math.random())],e=["Up","Left","Down","Right"][Math.floor(4*Math.random())];return i=i||"In",n+i+e}function o(i){var n=$(".ui-answer-desc b",i);n.addClass("animated swing")}$("#audio").on("click",function(i){i.preventDefault();var n=$(this).is(".off");$(this).toggleClass("off");var e=$("audio",this)[0];n?e.play():e.pause()});var s,a,d,u,c,r,h="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",f=0;s=$("#loadingPage"),s.show(function(){var i=$("img").length;$("img").each(function(n){function e(){$(".ui-loading-percent",s).text(Math.floor(100*(this.index+1)/i)+"%"),this.index==i-1&&s.trigger("load-finished")}var t=new Image;return t.index=n,t.src=this.src,t.complete?void e.call(t):void(t.onload=e)})}).addClass("fadeIn"),a=$("#homePage"),s.one("load-finished",function(){s.on(h,function(i){"fadeOut"===i.originalEvent.animationName&&(s.hide(),a.show(function(){a.addClass("fadeIn")}))}).addClass("fadeOut")}),d=$("#gamePage"),d.find("dd").addClass("animated");var l=$(".idiom-game-answer"),g="",m=[],w=l.find("dd"),p=$(".idiom-game-words dd",d);d.on("ui.hidden",function(){w.empty(),p.removeClass("bounce selected").off("click",i),l.removeClass("success")}).on("ui.shown",function(){g="",m=[],p.on("click",i)}),l.on("answer.answer",function(i,n){function t(){var i=setTimeout(function(){e(function(){d.hide(),$("#answerPage .ui-scroll-inner").hide(),$("#answerPage").show(function(){$(r.id,this).show()})},function(){g="",m=[]}),clearTimeout(i)},1e3)}function o(i,n){$(w.get(i)).empty().append($('<span class="animated fadeIn">').text(n))}var s=$(this);if(o(g.length,n),g+=n,4==g.length){var a=s.data("answer");if(g==a)f++,s.addClass("success"),t();else{s.addClass("fail");var u=setTimeout(function(){var i=a.split("");w.empty(),s.removeClass("fail").addClass("success"),$.each(i,o),t(),clearTimeout(u)},1e3)}}}),l.on("answer.cancel",function(i,n){for(var e=($(this),g.split(n)),t=g.indexOf(n),o=g.indexOf(n);o<g.length;o++)m[o].removeClass("selected bounce"),$("span",w.get(o)).one("animationend",function(){$(this).remove()}).addClass("fadeOut");g=e[0],m=m.slice(0,t)}),u=$("#answerPage"),$(".ui-answer-item").each(function(){$(this).addClass(t())}),$(".btn-next").on("click",function(){var i=$(this);e(function(){i.closest(".ui-page").hide(),d.show()})}),$("[data-idiom]").on("click",function(i){var t=$(this);e(function(){t.closest(".ui-page").hide(),n(t.data("idiom"),function(){d.show()})})}),c=$("#resultPage"),$("#btnScore").on("click",function(){e(function(){u.hide()},function(){c.show()})}),c.on("ui.shown",function(){var i=f<4?50:f<5?70:f<6?85:100;$(".score",this).attr("src","./images/idiom/result/score-"+i+".png"),$(".award",this).each(function(i){i>=f&&$(this).hide()})}),$(".ui-btn-replay").on("click",function(){window.location.reload(!0)}),$(".ui-btn-share").on("click",function(){$("#share").show()}),$("#share").on("click",function(){$(this).hide()}),$(".ui-daiyan").on("ui.shown",function(i){var n=$(".desc",this).hide(),e=$(".photo",this).hide();n.show().filter(":last").on(h,function(){e.show().addClass("bounceInDown")}).end().filter(":even").addClass("slideInLeft").end().filter(":odd").addClass("slideInRight")}),$(".ui-shigan").on("ui.shown",function(i){function n(i){return i>3?o(e):($(t.get(i)).show().addClass("bounceInDown"),$(s.get(i)).show().addClass("swing"),void setTimeout(function(){n(i+1)},300))}var e=this,t=$(".desc",this).hide(),s=$(".number",this).hide();n(0)}),$(".ui-tuixiao").on("ui.shown",function(i){function n(i){return i>3?o(e):($(t.get(i)).show().addClass(i>1?"bounceInUp":"bounceInDown"),void setTimeout(function(){n(i+1)},300))}var e=this,t=$(".desc",this).hide();$(".people",this).on(h,function(){n(0)}).addClass("zoomIn")}),$(".ui-feiren").on("ui.shown",function(i){function n(i){return i>3?o(e):($(t.get(i)).show().addClass(1&!i?"bounceInLeft":"bounceInRight"),$(s.get(i)).show().addClass(1&!i?"bounceInLeft":"bounceInRight"),void setTimeout(function(){n(i+1)},300))}var e=this,t=$(".time",this).hide(),s=$(".desc",this).hide();n(0)}),$(".ui-daoshi").on("ui.shown",function(i){function n(i){return i>3?o(e):($(t.get(i)).show().addClass("fadeInUp"),void setTimeout(function(){n(i+1)},300))}var e=this,t=$(".desc",this).hide();$(".decoration",this).on(h,function(){n(0)}).addClass("zoomInUp")})});